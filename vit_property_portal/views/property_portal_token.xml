<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="portal_my_property_list_token" name="Property Unit Token">
        <div id="token-table-wrapper" t-att-data-property-id="property_unit and property_unit.id or ''" class="mt-3">
            <div class="d-flex justify-content-between mt-3">
                <div>
                    <button type="button" id="btn-generate-token"
                        t-att-class="len(property_unit.token_ids) &gt; 0 and 'btn btn-dark px-4' or 'btn btn-primary px-4'"
                        t-att-disabled="len(property_unit.token_ids) &gt; 0 and 'disabled' or None">
                        Generate Token
                        <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                    </button>
                    <t t-if="len(property_unit.token_ids) &gt; 0">
                        <span class="text-muted ms-2">
                            <i class="fa fa-info-circle"></i> Token sudah digenerate
                        </span>
                    </t>
                </div>
                <nav aria-label="Token pagination">
                    <ul class="pagination justify-content-center mb-2">
                        <li class="page-item" t-att-class="page == 1 and 'disabled' or ''">
                            <a href="#" class="page-link token-page" t-att-data-page="max(page - 1, 1)">Previous</a>
                        </li>
                        <!-- <t t-foreach="range(1, page_count+1)" t-as="p">
                            <li class="page-item" t-att-class="p == page and 'active' or ''">
                                <a href="#" class="page-link token-page" t-att-data-page="p">
                                    <t t-esc="p"/>
                                </a>
                            </li>
                        </t> -->
                        <li class="page-item" t-att-class="page == page_count and 'disabled' or ''">
                            <a href="#" class="page-link token-page" t-att-data-page="min(page + 1, page_count)">Next</a>
                        </li>
                    </ul>
                </nav>
            </div>
            
            <table class="table table-striped table-hover table-bordered mt-3">
                <thead>
                    <tr class="bg-light">
                        <th class="text-center" scope="col">Name</th>
                        <th class="text-center" scope="col">Token State</th>
                        <th class="text-center" scope="col">Token Code</th>
                        <th class="text-center" scope="col">Token Type</th>
                        <th class="text-center" scope="col">Owner</th>
                        <th class="text-center" scope="col">Price</th>
                    </tr>
                </thead>
                <t t-call="vit_property_portal.portal_my_property_list_token_table"/>
            </table>
        </div>
    </template>

    <template id="portal_my_property_list_token_table" name="Token Table Partial">
        <tbody>
            <t t-if="tokens_page">
                <t t-foreach="tokens_page" t-as="token">
                    <tr>
                        <td><t t-esc="token.name"/></td>
                        <td class="text-center">
                            <t t-if="token.token_state == 'sold'">
                                <span class="badge bg-success">Sold</span>
                            </t>
                            <t t-elif="token.token_state == 'available'">
                                <span class="badge bg-info text-dark">Available</span>
                            </t>
                            <t t-else="">
                                <span class="badge bg-warning text-dark">Reserved</span>
                            </t>
                        </td>
                        <td><t t-esc="token.token_code"/></td>
                        <td><t t-esc="dict(token._fields['token_type'].selection).get(token.token_type)"/></td>
                        <td><t t-esc="token.token_owner_id.name"/></td>
                        <td>
                            <span t-esc="token.lst_price" t-options="{'widget': 'monetary', 'display_currency': property_unit.currency_id}" />
                        </td>
                    </tr>
                </t>
            </t>
            <t t-else="">
                <tr>
                    <td colspan="6" class="text-center text-muted">
                        Belum ada token
                    </td>
                </tr>
            </t>
        </tbody>
    </template>
</odoo>